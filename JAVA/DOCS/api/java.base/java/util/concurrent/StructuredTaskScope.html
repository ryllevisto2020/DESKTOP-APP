<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>StructuredTaskScope (Java SE 21 &amp; JDK 21)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: module: java.base, package: java.util.concurrent, class: StructuredTaskScope">
<meta name="generator" content="javadoc/ClassWriterImpl">
<meta name="keywords" content="java.util.concurrent.StructuredTaskScope class">
<meta name="keywords" content="ensureOwnerAndJoined()">
<meta name="keywords" content="handleComplete()">
<meta name="keywords" content="fork()">
<meta name="keywords" content="join()">
<meta name="keywords" content="joinUntil()">
<meta name="keywords" content="shutdown()">
<meta name="keywords" content="isShutdown()">
<meta name="keywords" content="close()">
<meta name="keywords" content="toString()">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<div class="about-language"><div style="margin-top: 14px;"><strong>Java SE 21 &amp; JDK 21</strong> </div></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="../../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/StructuredTaskScope.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../preview-list.html">Preview</a></li>
<li><a href="../../../../new-list.html">New</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li><a href="#nested-class-summary">Nested</a></li>
<li>Field</li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="module-label-in-type">Module</span>&nbsp;<a href="../../../module-summary.html">java.base</a></div>
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">java.util.concurrent</a></div>
<h1 title="Class StructuredTaskScope" class="title">Class StructuredTaskScope&lt;T&gt;</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="../../lang/Object.html" title="class in java.lang">java.lang.Object</a>
<div class="inheritance">java.util.concurrent.StructuredTaskScope&lt;T&gt;</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - the result type of tasks executed in the task scope</dd>
</dl>
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../../lang/AutoCloseable.html" title="interface in java.lang">AutoCloseable</a></code></dd>
</dl>
<dl class="notes">
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="StructuredTaskScope.ShutdownOnFailure.html" title="class in java.util.concurrent">StructuredTaskScope.ShutdownOnFailure</a><sup><a href="StructuredTaskScope.ShutdownOnFailure.html#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnFailure">PREVIEW</a></sup></code>, <code><a href="StructuredTaskScope.ShutdownOnSuccess.html" title="class in java.util.concurrent">StructuredTaskScope.ShutdownOnSuccess</a><sup><a href="StructuredTaskScope.ShutdownOnSuccess.html#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnSuccess">PREVIEW</a></sup></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">StructuredTaskScope&lt;T&gt;</span>
<span class="extends-implements">extends <a href="../../lang/Object.html" title="class in java.lang">Object</a>
implements <a href="../../lang/AutoCloseable.html" title="interface in java.lang">AutoCloseable</a></span></div>
<div class="preview-block" id="preview-java.util.concurrent.StructuredTaskScope"><span class="preview-label"><code>StructuredTaskScope</code> is a preview API of the Java platform.</span>
<div class="preview-comment">Programs can only use <code>StructuredTaskScope</code> when preview features are enabled.</div>
<div class="preview-comment">Preview features may be removed in a future release, or upgraded to permanent features of the Java platform.</div>
</div>
<div class="block">A basic API for <em>structured concurrency</em>. <code>StructuredTaskScope</code> supports
 cases where a task splits into several concurrent subtasks, and where the subtasks must
 complete before the main task continues. A <code>StructuredTaskScope</code> can be used to
 ensure that the lifetime of a concurrent operation is confined by a <em>syntax block</em>,
 just like that of a sequential operation in structured programming.

 <h2 id="basic-operation-heading">Basic operation</h2>

 A <code>StructuredTaskScope</code> is created with one of its public constructors. It defines
 the <a href="#fork(java.util.concurrent.Callable)"><code>fork</code></a> method to start a thread to execute a subtask, the <a href="#join()"><code>join</code></a> method to wait for all subtasks to finish, and the <a href="#close()"><code>close</code></a>
 method to close the task scope. The API is intended to be used with the <code>
 try-with-resources</code> statement. The intention is that code in the try <em>block</em>
 uses the <code>fork</code> method to fork threads to execute the subtasks, wait for the
 subtasks to finish with the <code>join</code> method, and then <em>process the results</em>.
 A call to the <code>fork</code> method returns a <a href="StructuredTaskScope.Subtask.html" title="interface in java.util.concurrent"><code>Subtask</code></a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup> to representing
 the <em>forked subtask</em>. Once <code>join</code> is called, the <code>Subtask</code> can be
 used to get the result completed successfully, or the exception if the subtask failed.
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">    Callable&lt;String&gt; task1 = ...
    Callable&lt;Integer&gt; task2 = ...

    try (var scope = new StructuredTaskScope&lt;Object&gt;()) {

        Subtask&lt;String&gt; subtask1 = scope.<span class="bold">fork</span>(task1);
        Subtask&lt;Integer&gt; subtask2 = scope.<span class="bold">fork</span>(task2);

        scope.<span class="bold">join</span>();

        ... process results/exceptions ...

    } // <span class="bold">close</span>
</code></pre>
</div>

 <p> The following example forks a collection of homogeneous subtasks, waits for all of
 them to complete with the <code>join</code> method, and uses the <a href="StructuredTaskScope.Subtask.State.html" title="enum class in java.util.concurrent"><code>Subtask.State</code></a><sup><a href="StructuredTaskScope.Subtask.State.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup> to partition the subtasks into a set of the subtasks that completed
 successfully and another for the subtasks that failed.
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">    List&lt;Callable&lt;String&gt;&gt; callables = ...

    try (var scope = new StructuredTaskScope&lt;String&gt;()) {

        List&lt;Subtask&lt;String&gt;&gt; subtasks = callables.stream().map(scope::fork).toList();

        scope.join();

        Map&lt;Boolean, Set&lt;Subtask&lt;String&gt;&gt;&gt; map = subtasks.stream()
                .collect(Collectors.partitioningBy(h -&gt; h.state() == Subtask.State.SUCCESS,
                                                   Collectors.toSet()));

    } // close
</code></pre>
</div>


 <p> To ensure correct usage, the <code>join</code> and <code>close</code> methods may only be
 invoked by the <em>owner</em> (the thread that opened/created the task scope), and the
 <code>close</code> method throws an exception after closing if the owner did not invoke the
 <code>join</code> method after forking.

 <p> <code>StructuredTaskScope</code> defines the <a href="#shutdown()"><code>shutdown</code></a> method to shut
 down a task scope without closing it. The <code>shutdown()</code> method <em>cancels</em> all
 unfinished subtasks by <a href="../../lang/Thread.html#interrupt()">interrupting</a> the threads. It
 prevents new threads from starting in the task scope. If the owner is waiting in the
 <code>join</code> method then it will wakeup.

 <p> Shutdown is used for <em>short-circuiting</em> and allow subclasses to implement
 <em>policy</em> that does not require all subtasks to finish.

 <h2 id="subclasses-with-policies-for-common-cases-heading">Subclasses with policies for common cases</h2>

 Two subclasses of <code>StructuredTaskScope</code> are defined to implement policy for
 common cases:
 <ol>
   <li> <a href="StructuredTaskScope.ShutdownOnSuccess.html" title="class in java.util.concurrent"><code>ShutdownOnSuccess</code></a><sup><a href="StructuredTaskScope.ShutdownOnSuccess.html#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnSuccess">PREVIEW</a></sup> captures the result of the first
   subtask to complete successfully. Once captured, it shuts down the task scope to
   interrupt unfinished threads and wakeup the owner. This class is intended for cases
   where the result of any subtask will do ("invoke any") and where there is no need to
   wait for results of other unfinished subtasks. It defines methods to get the first
   result or throw an exception if all subtasks fail.
   <li> <a href="StructuredTaskScope.ShutdownOnFailure.html" title="class in java.util.concurrent"><code>ShutdownOnFailure</code></a><sup><a href="StructuredTaskScope.ShutdownOnFailure.html#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnFailure">PREVIEW</a></sup> captures the exception of the first
   subtask to fail. Once captured, it shuts down the task scope to interrupt unfinished
   threads and wakeup the owner. This class is intended for cases where the results of all
   subtasks are required ("invoke all"); if any subtask fails then the results of other
   unfinished subtasks are no longer needed. If defines methods to throw an exception if
   any of the subtasks fail.
 </ol>

 <p> The following are two examples that use the two classes. In both cases, a pair of
 subtasks are forked to fetch resources from two URL locations "left" and "right". The
 first example creates a ShutdownOnSuccess object to capture the result of the first
 subtask to complete successfully, cancelling the other by way of shutting down the task
 scope. The main task waits in <code>join</code> until either subtask completes with a result
 or both subtasks fail. It invokes <a href="StructuredTaskScope.ShutdownOnSuccess.html#result(java.util.function.Function)"><code>result(Function)</code></a><sup><a href="StructuredTaskScope.ShutdownOnSuccess.html#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnSuccess">PREVIEW</a></sup> method to get the captured result. If both subtasks fail then this
 method throws a <code>WebApplicationException</code> with the exception from one of the
 subtasks as the cause.
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">    try (var scope = new StructuredTaskScope.ShutdownOnSuccess&lt;String&gt;()) {

        scope.fork(() -&gt; fetch(left));
        scope.fork(() -&gt; fetch(right));

        scope.join();

        String result = scope.<a href="StructuredTaskScope.ShutdownOnSuccess.html#result()"><code>result</code></a>(e -&gt; new WebApplicationException(e));

        ...
    }
</code></pre>
</div>

 The second example creates a ShutdownOnFailure object to capture the exception of the
 first subtask to fail, cancelling the other by way of shutting down the task scope. The
 main task waits in <a href="#joinUntil(java.time.Instant)"><code>joinUntil(Instant)</code></a> until both subtasks complete with a
 result, either fails, or a deadline is reached. It invokes <a href="StructuredTaskScope.ShutdownOnFailure.html#throwIfFailed(java.util.function.Function)"><code>throwIfFailed(Function)</code></a><sup><a href="StructuredTaskScope.ShutdownOnFailure.html#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnFailure">PREVIEW</a></sup> to throw an exception
 if either subtask fails. This method is a no-op if both subtasks complete successfully.
 The example uses <a href="../function/Supplier.html#get()"><code>Supplier.get()</code></a> to get the result of each subtask. Using
 <code>Supplier</code> instead of <code>Subtask</code> is preferred for common cases where the
 object returned by fork is only used to get the result of a subtask that completed
 successfully.
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">   Instant deadline = ...

   try (var scope = new StructuredTaskScope.ShutdownOnFailure()) {

        Supplier&lt;String&gt; supplier1 = scope.fork(() -&gt; query(left));
        Supplier&lt;String&gt; supplier2 = scope.fork(() -&gt; query(right));

        scope.joinUntil(deadline);

        scope.<a href="StructuredTaskScope.ShutdownOnFailure.html#throwIfFailed()"><code>throwIfFailed</code></a>(e -&gt; new WebApplicationException(e));

        // both subtasks completed successfully
        String result = Stream.of(supplier1, supplier2)
                .map(Supplier::get)
                .collect(Collectors.joining(", ", "{ ", " }"));

        ...
    }
</code></pre>
</div>


 <h2 id="extending-structuredtaskscope-heading">Extending StructuredTaskScope</h2>

 <code>StructuredTaskScope</code> can be extended, and the <a href="#handleComplete(java.util.concurrent.StructuredTaskScope.Subtask)"><code>handleComplete</code></a> method overridden, to implement policies other than those implemented
 by <code>ShutdownOnSuccess</code> and <code>ShutdownOnFailure</code>. A subclass may, for example,
 collect the results of subtasks that complete successfully and ignore subtasks that
 fail. It may collect exceptions when subtasks fail. It may invoke the <a href="#shutdown()"><code>shutdown</code></a> method to shut down and cause <a href="#join()"><code>join</code></a> to wakeup when some
 condition arises.

 <p> A subclass will typically define methods to make available results, state, or other
 outcome to code that executes after the <code>join</code> method. A subclass that collects
 results and ignores subtasks that fail may define a method that returns the results.
 A subclass that implements a policy to shut down when a subtask fails may define a
 method to get the exception of the first subtask to fail.

 <p> The following is an example of a simple <code>StructuredTaskScope</code> implementation
 that collects homogenous subtasks that complete successfully. It defines the method
 "<code>completedSuccessfully()</code>" that the main task can invoke after it joins.
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">    class CollectingScope&lt;T&gt; extends StructuredTaskScope&lt;T&gt; {
        private final Queue&lt;Subtask&lt;? extends T&gt;&gt; subtasks = new LinkedTransferQueue&lt;&gt;();

        @Override
        protected void handleComplete(Subtask&lt;? extends T&gt; subtask) {
            if (subtask.state() == Subtask.State.SUCCESS) {
                subtasks.add(subtask);
            }
        }

        @Override
        public CollectingScope&lt;T&gt; join() throws InterruptedException {
            super.join();
            return this;
        }

        public Stream&lt;Subtask&lt;? extends T&gt;&gt; completedSuccessfully() {
            super.<a href="#ensureOwnerAndJoined()"><code>ensureOwnerAndJoined</code></a>();
            return subtasks.stream();
        }
    }
</code></pre>
</div>

 <p> The implementations of the <code>completedSuccessfully()</code> method in the example
 invokes <a href="#ensureOwnerAndJoined()"><code>ensureOwnerAndJoined()</code></a> to ensure that the method can only be invoked
 by the owner thread and only after it has joined.

 <h2><a id="TreeStructure">Tree structure</a></h2>

 Task scopes form a tree where parent-child relations are established implicitly when
 opening a new task scope:
 <ul>
   <li> A parent-child relation is established when a thread started in a task scope
   opens its own task scope. A thread started in task scope "A" that opens task scope
   "B" establishes a parent-child relation where task scope "A" is the parent of task
   scope "B".
   <li> A parent-child relation is established with nesting. If a thread opens task
   scope "B", then opens task scope "C" (before it closes "B"), then the enclosing task
   scope "B" is the parent of the nested task scope "C".
 </ul>

 The <i>descendants</i> of a task scope are the child task scopes that it is a parent
 of, plus the descendants of the child task scopes, recursively.

 <p> The tree structure supports:
 <ul>
   <li> Inheritance of <a href="../../lang/ScopedValue.html" title="class in java.lang">scoped values</a><sup><a href="../../lang/ScopedValue.html#preview-java.lang.ScopedValue">PREVIEW</a></sup> across threads.
   <li> Confinement checks. The phrase "threads contained in the task scope" in method
   descriptions means threads started in the task scope or descendant scopes.
 </ul>

 <p> The following example demonstrates the inheritance of a scoped value. A scoped
 value <code>USERNAME</code> is bound to the value "<code>duke</code>". A <code>StructuredTaskScope</code>
 is created and its <code>fork</code> method invoked to start a thread to execute <code>
 childTask</code>. The thread inherits the scoped value <em>bindings</em> captured when
 creating the task scope. The code in <code>childTask</code> uses the value of the scoped
 value and so reads the value "<code>duke</code>".
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">    private static final ScopedValue&lt;String&gt; USERNAME = ScopedValue.newInstance();

    ScopedValue.<a href="../../lang/ScopedValue.html#runWhere(java.lang.ScopedValue,T,java.lang.Runnable)"><code>runWhere</code></a>(USERNAME, "duke", () -&gt; {
        try (var scope = new StructuredTaskScope&lt;String&gt;()) {

            scope.<span class="bold">fork</span>(() -&gt; childTask());
            ...
         }
    });

    ...

    String childTask() {
        String name = USERNAME.<a href="../../lang/ScopedValue.html#get()"><code>get</code></a>();   // "duke"
        ...
    }
</code></pre>
</div>


 <p> <code>StructuredTaskScope</code> does not define APIs that exposes the tree structure
 at this time.

 <p> Unless otherwise specified, passing a <code>null</code> argument to a constructor
 or method in this class will cause a <a href="../../lang/NullPointerException.html" title="class in java.lang"><code>NullPointerException</code></a> to be thrown.

 <h2 id="memory-consistency-effects-heading">Memory consistency effects</h2>

 <p> Actions in the owner thread of, or a thread contained in, the task scope prior to
 <a href="#fork(java.util.concurrent.Callable)">forking</a> of a subtask
 <a href="../../../../java.base/java/util/concurrent/package-summary.html#MemoryVisibility">
 <i>happen-before</i></a> any actions taken by that subtask, which in turn <i>happen-before</i>
 the subtask result is <a href="StructuredTaskScope.Subtask.html#get()">retrieved</a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup> or <i>happen-before</i> any
 actions taken in a thread after <a href="#join()">joining</a> of the task scope.</div>
<dl class="notes"><dt>See <i>Java Language Specification</i>:</dt>
<dd>
<a href="https://docs.oracle.com/javase/specs/jls/se21/html/jls-17.html#jls-17.4.5">17.4.5 Happens-before Order</a><br></dd>
<dt>Since:</dt>
<dd>21</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="StructuredTaskScope.ShutdownOnFailure.html" class="type-name-link" title="class in java.util.concurrent">StructuredTaskScope.ShutdownOnFailure</a><sup><a href="StructuredTaskScope.ShutdownOnFailure.html#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnFailure">PREVIEW</a></sup></code></div>
<div class="col-last even-row-color">
<div class="block"><span class="preview-label">Preview.</span></div>
<div class="block">A <code>StructuredTaskScope</code> that captures the exception of the first subtask to
 <a href="StructuredTaskScope.Subtask.State.html#FAILED">fail</a><sup><a href="StructuredTaskScope.Subtask.State.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>.</div>
</div>
<div class="col-first odd-row-color"><code>static final class&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="StructuredTaskScope.ShutdownOnSuccess.html" class="type-name-link" title="class in java.util.concurrent">StructuredTaskScope.ShutdownOnSuccess</a><sup><a href="StructuredTaskScope.ShutdownOnSuccess.html#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnSuccess">PREVIEW</a></sup>&lt;<a href="StructuredTaskScope.ShutdownOnSuccess.html" title="type parameter in StructuredTaskScope.ShutdownOnSuccess">T</a>&gt;</code></div>
<div class="col-last odd-row-color">
<div class="block"><span class="preview-label">Preview.</span></div>
<div class="block">A <code>StructuredTaskScope</code> that captures the result of the first subtask to
 complete <a href="StructuredTaskScope.Subtask.State.html#SUCCESS">successfully</a><sup><a href="StructuredTaskScope.Subtask.State.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>.</div>
</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="StructuredTaskScope.Subtask.html" class="type-name-link" title="interface in java.util.concurrent">StructuredTaskScope.Subtask</a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup>&lt;<a href="StructuredTaskScope.Subtask.html" title="type parameter in StructuredTaskScope.Subtask">T</a>&gt;</code></div>
<div class="col-last even-row-color">
<div class="block"><span class="preview-label">Preview.</span></div>
<div class="block">Represents a subtask forked with <a href="#fork(java.util.concurrent.Callable)"><code>fork(Callable)</code></a>.</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">StructuredTaskScope</a>()</code></div>
<div class="col-last even-row-color">
<div class="block">Creates an unnamed structured task scope that creates virtual threads.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(java.lang.String,java.util.concurrent.ThreadFactory)" class="member-name-link">StructuredTaskScope</a><wbr>(<a href="../../lang/String.html" title="class in java.lang">String</a>&nbsp;name,
 <a href="ThreadFactory.html" title="interface in java.util.concurrent">ThreadFactory</a>&nbsp;factory)</code></div>
<div class="col-last odd-row-color">
<div class="block">Creates a structured task scope with the given name and thread factory.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#close()" class="member-name-link">close</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Closes this task scope.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected final void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#ensureOwnerAndJoined()" class="member-name-link">ensureOwnerAndJoined</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Ensures that the current thread is the owner of this task scope and that it joined
 (with <a href="#join()"><code>join()</code></a> or <a href="#joinUntil(java.time.Instant)"><code>joinUntil(Instant)</code></a>) after <a href="#fork(java.util.concurrent.Callable)">forking</a> subtasks.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;U extends <a href="StructuredTaskScope.html" title="type parameter in StructuredTaskScope">T</a>&gt;<br><a href="StructuredTaskScope.Subtask.html" title="interface in java.util.concurrent">StructuredTaskScope.Subtask</a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup><wbr>&lt;U&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#fork(java.util.concurrent.Callable)" class="member-name-link">fork</a><wbr>(<a href="Callable.html" title="interface in java.util.concurrent">Callable</a>&lt;? extends U&gt;&nbsp;task)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Starts a new thread in this task scope to execute a value-returning task, thus
 creating a <em>subtask</em> of this task scope.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#handleComplete(java.util.concurrent.StructuredTaskScope.Subtask)" class="member-name-link">handleComplete</a><wbr>(<a href="StructuredTaskScope.Subtask.html" title="interface in java.util.concurrent">StructuredTaskScope.Subtask</a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup>&lt;? extends <a href="StructuredTaskScope.html" title="type parameter in StructuredTaskScope">T</a>&gt;&nbsp;subtask)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Invoked by a subtask when it completes successfully or fails in this task scope.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>final boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isShutdown()" class="member-name-link">isShutdown</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns true if this task scope is shutdown, otherwise false.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="StructuredTaskScope.html" title="class in java.util.concurrent">StructuredTaskScope</a><sup><a href="#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup><wbr>&lt;<a href="StructuredTaskScope.html" title="type parameter in StructuredTaskScope">T</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#join()" class="member-name-link">join</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Wait for all subtasks started in this task scope to finish or the task scope to
 shut down.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="StructuredTaskScope.html" title="class in java.util.concurrent">StructuredTaskScope</a><sup><a href="#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup><wbr>&lt;<a href="StructuredTaskScope.html" title="type parameter in StructuredTaskScope">T</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#joinUntil(java.time.Instant)" class="member-name-link">joinUntil</a><wbr>(<a href="../../time/Instant.html" title="class in java.time">Instant</a>&nbsp;deadline)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Wait for all subtasks started in this task scope to finish or the task scope to
 shut down, up to the given deadline.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#shutdown()" class="member-name-link">shutdown</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Shut down this task scope without closing it.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods declared in class&nbsp;java.lang.<a href="../../lang/Object.html" title="class in java.lang">Object</a></h3>
<code><a href="../../lang/Object.html#clone()">clone</a>, <a href="../../lang/Object.html#equals(java.lang.Object)">equals</a>, <a href="../../lang/Object.html#finalize()">finalize</a>, <a href="../../lang/Object.html#getClass()">getClass</a>, <a href="../../lang/Object.html#hashCode()">hashCode</a>, <a href="../../lang/Object.html#notify()">notify</a>, <a href="../../lang/Object.html#notifyAll()">notifyAll</a>, <a href="../../lang/Object.html#toString()">toString</a>, <a href="../../lang/Object.html#wait()">wait</a>, <a href="../../lang/Object.html#wait(long)">wait</a>, <a href="../../lang/Object.html#wait(long,int)">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(java.lang.String,java.util.concurrent.ThreadFactory)">
<h3>StructuredTaskScope</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">StructuredTaskScope</span><wbr><span class="parameters">(<a href="../../lang/String.html" title="class in java.lang">String</a>&nbsp;name,
 <a href="ThreadFactory.html" title="interface in java.util.concurrent">ThreadFactory</a>&nbsp;factory)</span></div>
<div class="block">Creates a structured task scope with the given name and thread factory. The task
 scope is optionally named for the purposes of monitoring and management. The thread
 factory is used to <a href="ThreadFactory.html#newThread(java.lang.Runnable)"><code>create</code></a> threads when
 subtasks are <a href="#fork(java.util.concurrent.Callable)">forked</a>. The task scope is owned by the
 current thread.

 <p> Construction captures the current thread's <a href="../../lang/ScopedValue.html" title="class in java.lang">scoped value</a><sup><a href="../../lang/ScopedValue.html#preview-java.lang.ScopedValue">PREVIEW</a></sup>
 bindings for inheritance by threads started in the task scope. The
 <a href="#TreeStructure">Tree Structure</a> section in the class description details
 how parent-child relations are established implicitly for the purpose of inheritance
 of scoped value bindings.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>name</code> - the name of the task scope, can be null</dd>
<dd><code>factory</code> - the thread factory</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>StructuredTaskScope</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">StructuredTaskScope</span>()</div>
<div class="block">Creates an unnamed structured task scope that creates virtual threads. The task
 scope is owned by the current thread.</div>
<dl class="notes">
<dt>Implementation Requirements:</dt>
<dd>This constructor is equivalent to invoking the 2-arg constructor with a
 name of <code>null</code> and a thread factory that creates virtual threads.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="ensureOwnerAndJoined()">
<h3>ensureOwnerAndJoined</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">ensureOwnerAndJoined</span>()</div>
<div class="block">Ensures that the current thread is the owner of this task scope and that it joined
 (with <a href="#join()"><code>join()</code></a> or <a href="#joinUntil(java.time.Instant)"><code>joinUntil(Instant)</code></a>) after <a href="#fork(java.util.concurrent.Callable)">forking</a> subtasks.</div>
<dl class="notes">
<dt>API Note:</dt>
<dd>This method can be used by subclasses that define methods to make available
 results, state, or other outcome to code intended to execute after the join method.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../lang/WrongThreadException.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner</dd>
<dd><code><a href="../../lang/IllegalStateException.html" title="class in java.lang">IllegalStateException</a></code> - if the task scope is open and task scope owner did
 not join after forking</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="handleComplete(java.util.concurrent.StructuredTaskScope.Subtask)">
<h3>handleComplete</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">handleComplete</span><wbr><span class="parameters">(<a href="StructuredTaskScope.Subtask.html" title="interface in java.util.concurrent">StructuredTaskScope.Subtask</a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup>&lt;? extends <a href="StructuredTaskScope.html" title="type parameter in StructuredTaskScope">T</a>&gt;&nbsp;subtask)</span></div>
<div class="block">Invoked by a subtask when it completes successfully or fails in this task scope.
 This method is not invoked if a subtask completes after the task scope is
 <a href="#shutdown()">shut down</a>.</div>
<dl class="notes">
<dt>API Note:</dt>
<dd>The <code>handleComplete</code> method should be thread safe. It may be
 invoked by several threads concurrently.</dd>
<dt>Implementation Requirements:</dt>
<dd>The default implementation throws <code>NullPointerException</code> if the
 subtask is <code>null</code>. It throws <a href="../../lang/IllegalArgumentException.html" title="class in java.lang"><code>IllegalArgumentException</code></a> if the subtask
 has not completed.</dd>
<dt>Parameters:</dt>
<dd><code>subtask</code> - the subtask</dd>
<dt>Throws:</dt>
<dd><code><a href="../../lang/IllegalArgumentException.html" title="class in java.lang">IllegalArgumentException</a></code> - if called with a subtask that has not completed</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="fork(java.util.concurrent.Callable)">
<h3>fork</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;U extends <a href="StructuredTaskScope.html" title="type parameter in StructuredTaskScope">T</a>&gt;</span>
<span class="return-type"><a href="StructuredTaskScope.Subtask.html" title="interface in java.util.concurrent">StructuredTaskScope.Subtask</a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup>&lt;U&gt;</span>&nbsp;<span class="element-name">fork</span><wbr><span class="parameters">(<a href="Callable.html" title="interface in java.util.concurrent">Callable</a>&lt;? extends U&gt;&nbsp;task)</span></div>
<div class="block">Starts a new thread in this task scope to execute a value-returning task, thus
 creating a <em>subtask</em> of this task scope.

 <p> The value-returning task is provided to this method as a <a href="Callable.html" title="interface in java.util.concurrent"><code>Callable</code></a>, the
 thread executes the task's <a href="Callable.html#call()"><code>call</code></a> method. The thread is
 created with the task scope's <a href="ThreadFactory.html" title="interface in java.util.concurrent"><code>ThreadFactory</code></a>. It inherits the current thread's
 <a href="../../lang/ScopedValue.html" title="class in java.lang">scoped value</a><sup><a href="../../lang/ScopedValue.html#preview-java.lang.ScopedValue">PREVIEW</a></sup> bindings. The bindings must match the bindings
 captured when the task scope was created.

 <p> This method returns a <a href="StructuredTaskScope.Subtask.html" title="interface in java.util.concurrent"><code>Subtask</code></a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup> to represent the <em>forked
 subtask</em>. The <code>Subtask</code> object can be used to obtain the result when
 the subtask completes successfully, or the exception when the subtask fails. To
 ensure correct usage, the <a href="StructuredTaskScope.Subtask.html#get()"><code>get()</code></a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup> and <a href="StructuredTaskScope.Subtask.html#exception()"><code>exception()</code></a><sup><a href="StructuredTaskScope.Subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup> methods may only be called by the task scope owner after it has waited
 for all threads to finish with the <a href="#join()"><code>join</code></a> or <a href="#joinUntil(java.time.Instant)"><code>joinUntil(Instant)</code></a>
 methods. When the subtask completes, the thread invokes the <a href="#handleComplete(java.util.concurrent.StructuredTaskScope.Subtask)"><code>handleComplete</code></a> method to consume the completed subtask.
 If the task scope is <a href="#shutdown()">shut down</a> before the subtask completes
 then the <code>handleComplete</code> method will not be invoked.

 <p> If this task scope is <a href="#shutdown()">shutdown</a> (or in the process of
 shutting down) then the subtask will not run and the <code>handleComplete</code> method
 will not be invoked.

 <p> This method may only be invoked by the task scope owner or threads contained
 in the task scope.</div>
<dl class="notes">
<dt>Implementation Requirements:</dt>
<dd>This method may be overridden for customization purposes, wrapping tasks
 for example. If overridden, the subclass must invoke <code>super.fork</code> to start a
 new thread in this task scope.</dd>
<dt>Type Parameters:</dt>
<dd><code>U</code> - the result type</dd>
<dt>Parameters:</dt>
<dd><code>task</code> - the value-returning task for the thread to execute</dd>
<dt>Returns:</dt>
<dd>the subtask</dd>
<dt>Throws:</dt>
<dd><code><a href="../../lang/IllegalStateException.html" title="class in java.lang">IllegalStateException</a></code> - if this task scope is closed</dd>
<dd><code><a href="../../lang/WrongThreadException.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner or a
 thread contained in the task scope</dd>
<dd><code><a href="StructureViolationException.html" title="class in java.util.concurrent">StructureViolationException</a><sup><a href="StructureViolationException.html#preview-java.util.concurrent.StructureViolationException">PREVIEW</a></sup></code> - if the current scoped value bindings are not
 the same as when the task scope was created</dd>
<dd><code><a href="RejectedExecutionException.html" title="class in java.util.concurrent">RejectedExecutionException</a></code> - if the thread factory rejected creating a
 thread to run the subtask</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="join()">
<h3>join</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="StructuredTaskScope.html" title="class in java.util.concurrent">StructuredTaskScope</a><sup><a href="#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>&lt;<a href="StructuredTaskScope.html" title="type parameter in StructuredTaskScope">T</a>&gt;</span>&nbsp;<span class="element-name">join</span>()
                                   throws <span class="exceptions"><a href="../../lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></span></div>
<div class="block">Wait for all subtasks started in this task scope to finish or the task scope to
 shut down.

 <p> This method waits for all subtasks by waiting for all threads <a href="#fork(java.util.concurrent.Callable)">started</a> in this task scope to finish execution. It stops waiting
 when all threads finish, the task scope is <a href="#shutdown()">shut down</a>, or
 the current thread is <a href="../../lang/Thread.html#interrupt()">interrupted</a>.

 <p> This method may only be invoked by the task scope owner.</div>
<dl class="notes">
<dt>Implementation Requirements:</dt>
<dd>This method may be overridden for customization purposes or to return a
 more specific return type. If overridden, the subclass must invoke <code>
 super.join</code> to ensure that the method waits for threads in this task scope to
 finish.</dd>
<dt>Returns:</dt>
<dd>this task scope</dd>
<dt>Throws:</dt>
<dd><code><a href="../../lang/IllegalStateException.html" title="class in java.lang">IllegalStateException</a></code> - if this task scope is closed</dd>
<dd><code><a href="../../lang/WrongThreadException.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner</dd>
<dd><code><a href="../../lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></code> - if interrupted while waiting</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="joinUntil(java.time.Instant)">
<h3>joinUntil</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="StructuredTaskScope.html" title="class in java.util.concurrent">StructuredTaskScope</a><sup><a href="#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>&lt;<a href="StructuredTaskScope.html" title="type parameter in StructuredTaskScope">T</a>&gt;</span>&nbsp;<span class="element-name">joinUntil</span><wbr><span class="parameters">(<a href="../../time/Instant.html" title="class in java.time">Instant</a>&nbsp;deadline)</span>
                                        throws <span class="exceptions"><a href="../../lang/InterruptedException.html" title="class in java.lang">InterruptedException</a>,
<a href="TimeoutException.html" title="class in java.util.concurrent">TimeoutException</a></span></div>
<div class="block">Wait for all subtasks started in this task scope to finish or the task scope to
 shut down, up to the given deadline.

 <p> This method waits for all subtasks by waiting for all threads <a href="#fork(java.util.concurrent.Callable)">started</a> in this task scope to finish execution. It stops waiting
 when all threads finish, the task scope is <a href="#shutdown()">shut down</a>, the
 deadline is reached, or the current thread is <a href="../../lang/Thread.html#interrupt()">interrupted</a>.

 <p> This method may only be invoked by the task scope owner.</div>
<dl class="notes">
<dt>Implementation Requirements:</dt>
<dd>This method may be overridden for customization purposes or to return a
 more specific return type. If overridden, the subclass must invoke <code>
 super.joinUntil</code> to ensure that the method waits for threads in this task scope to
 finish.</dd>
<dt>Parameters:</dt>
<dd><code>deadline</code> - the deadline</dd>
<dt>Returns:</dt>
<dd>this task scope</dd>
<dt>Throws:</dt>
<dd><code><a href="../../lang/IllegalStateException.html" title="class in java.lang">IllegalStateException</a></code> - if this task scope is closed</dd>
<dd><code><a href="../../lang/WrongThreadException.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner</dd>
<dd><code><a href="../../lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></code> - if interrupted while waiting</dd>
<dd><code><a href="TimeoutException.html" title="class in java.util.concurrent">TimeoutException</a></code> - if the deadline is reached while waiting</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="shutdown()">
<h3>shutdown</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">shutdown</span>()</div>
<div class="block">Shut down this task scope without closing it. Shutting down a task scope prevents
 new threads from starting, interrupts all unfinished threads, and causes the
 <a href="#join()"><code>join</code></a> method to wakeup. Shutdown is useful for cases where the
 results of unfinished subtasks are no longer needed. It will typically be called
 by the <a href="#handleComplete(java.util.concurrent.StructuredTaskScope.Subtask)"><code>handleComplete(Subtask)</code></a> implementation of a subclass that
 implements a policy to discard unfinished tasks once some outcome is reached.

 <p> More specifically, this method:
 <ul>
 <li> <a href="../../lang/Thread.html#interrupt()">Interrupts</a> all unfinished threads in the
 task scope (except the current thread).
 <li> Wakes up the task scope owner if it is waiting in <a href="#join()"><code>join()</code></a> or <a href="#joinUntil(java.time.Instant)"><code>joinUntil(Instant)</code></a>. If the task scope owner is not waiting then its next call to
 <code>join</code> or <code>joinUntil</code> will return immediately.
 </ul>

 <p> This method may only be invoked by the task scope owner or threads contained
 in the task scope.</div>
<dl class="notes">
<dt>API Note:</dt>
<dd>There may be threads that have not finished because they are executing code that
 did not respond (or respond promptly) to thread interrupt. This method does not wait
 for these threads. When the owner invokes the <a href="#close()"><code>close</code></a> method
 to close the task scope then it will wait for the remaining threads to finish.</dd>
<dt>Implementation Requirements:</dt>
<dd>This method may be overridden for customization purposes. If overridden,
 the subclass must invoke <code>super.shutdown</code> to ensure that the method shuts
 down the task scope.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../lang/IllegalStateException.html" title="class in java.lang">IllegalStateException</a></code> - if this task scope is closed</dd>
<dd><code><a href="../../lang/WrongThreadException.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner or
 a thread contained in the task scope</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#isShutdown()"><code>isShutdown()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isShutdown()">
<h3>isShutdown</h3>
<div class="member-signature"><span class="modifiers">public final</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isShutdown</span>()</div>
<div class="block">Returns true if this task scope is shutdown, otherwise false.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>true if this task scope is shutdown, otherwise false</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#shutdown()"><code>shutdown()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="close()">
<h3>close</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">close</span>()</div>
<div class="block">Closes this task scope.

 <p> This method first shuts down the task scope (as if by invoking the <a href="#shutdown()"><code>shutdown</code></a> method). It then waits for the threads executing any
 unfinished tasks to finish. If interrupted, this method will continue to wait for
 the threads to finish before completing with the interrupt status set.

 <p> This method may only be invoked by the task scope owner. If the task scope
 is already closed then the task scope owner invoking this method has no effect.

 <p> A <code>StructuredTaskScope</code> is intended to be used in a <em>structured
 manner</em>. If this method is called to close a task scope before nested task
 scopes are closed then it closes the underlying construct of each nested task scope
 (in the reverse order that they were created in), closes this task scope, and then
 throws <a href="StructureViolationException.html" title="class in java.util.concurrent"><code>StructureViolationException</code></a><sup><a href="StructureViolationException.html#preview-java.util.concurrent.StructureViolationException">PREVIEW</a></sup>.
 Similarly, if this method is called to close a task scope while executing with
 <a href="../../lang/ScopedValue.html" title="class in java.lang">scoped value</a><sup><a href="../../lang/ScopedValue.html#preview-java.lang.ScopedValue">PREVIEW</a></sup> bindings, and the task scope was created
 before the scoped values were bound, then <code>StructureViolationException</code> is
 thrown after closing the task scope.
 If a thread terminates without first closing task scopes that it owns then
 termination will cause the underlying construct of each of its open tasks scopes to
 be closed. Closing is performed in the reverse order that the task scopes were
 created in. Thread termination may therefore be delayed when the task scope owner
 has to wait for threads forked in these task scopes to finish.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../../lang/AutoCloseable.html#close()">close</a></code>&nbsp;in interface&nbsp;<code><a href="../../lang/AutoCloseable.html" title="interface in java.lang">AutoCloseable</a></code></dd>
<dt>Implementation Requirements:</dt>
<dd>This method may be overridden for customization purposes. If overridden,
 the subclass must invoke <code>super.close</code> to close the task scope.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../lang/IllegalStateException.html" title="class in java.lang">IllegalStateException</a></code> - thrown after closing the task scope if the task scope
 owner did not attempt to join after forking</dd>
<dd><code><a href="../../lang/WrongThreadException.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner</dd>
<dd><code><a href="StructureViolationException.html" title="class in java.util.concurrent">StructureViolationException</a><sup><a href="StructureViolationException.html#preview-java.util.concurrent.StructureViolationException">PREVIEW</a></sup></code> - if a structure violation was detected</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><a href="https://bugreport.java.com/bugreport/">Report a bug or suggest an enhancement</a><br> For further API reference and developer documentation see the <a href="https://docs.oracle.com/pls/topic/lookup?ctx=javase21&amp;id=homepage" target="_blank">Java SE Documentation</a>, which contains more detailed, developer-targeted descriptions with conceptual overviews, definitions of terms, workarounds, and working code examples. <a href="https://docs.oracle.com/en/java/javase/index.html">Other versions.</a><br> Java is a trademark or registered trademark of Oracle and/or its affiliates in the US and other countries.<br> <a href="../../../../../legal/copyright.html">Copyright</a> &copy; 1993, 2024, Oracle and/or its affiliates, 500 Oracle Parkway, Redwood Shores, CA 94065 USA.<br>All rights reserved. Use is subject to <a href="https://www.oracle.com/java/javase/terms/license/java21speclicense.html">license terms</a> and the <a href="https://www.oracle.com/technetwork/java/redist-137594.html">documentation redistribution policy</a>. <!-- Version 21.0.2+13-LTS-58 --></small></p>
</footer>
</div>
</div>
</body>
</html>
